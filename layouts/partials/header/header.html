{{ $primary := partial "GetMenu" "primary" }}
{{ $upper_menu := partial "GetMenu" "upper-menu" }}

{{ $home_url := site.Home.Permalink  }}
{{ if site.Params.custom.external_logo_link.active }}
    {{ $home_url = site.Params.custom.external_logo_link.url }}
{{ end }}

<header id="document-header" role="banner" {{ if $upper_menu.items }} class="has-upper-menu" {{ end }}>
    <!-- Thematic logo on top on mobile -->
    <div class="header-mobile-logo">
        <div class="container">
            {{ partial "commons/logo.html" }}
        </div>
    </div>

    <nav class="primary-menu" aria-label="{{ i18n " commons.menu.main" }}">
        <div class="container">
            {{ partial "header/logo.html" }}

            <!-- Todo add custom search form -->

            {{ if $primary.items }}
                {{ partial "header/button.html" }}
                <div class="menu" id="navigation">
                    {{ partial "commons/menu.html"
                    (dict
                        "kind" "primary"
                        "dropdown" true
                        "level" 1
                        "context" .
                    )}}
                </div>
            {{ end }}
        </div>
    </nav>

    {{ if $upper_menu.items }}
        <nav class="upper-menu" aria-label="{{ i18n "commons.menu.upper" }}">
            <div class="container">
                {{ partial "commons/logo.html" }}
                {{ partial "commons/menu.html" (dict
                    "context" .
                    "ignore_externals" true
                    "kind" "upper-menu"
                    "level" 1
                    "stop" 1
                )}}
            </div>
        </nav>
    {{ end }}

    <div class="header-mobile-nav">
        <div class="container">
            <!-- Search CTA (native or custom) -->
            {{ partial "commons/search/button.html" "custom-fixed" }}
            {{ if site.Params.custom.search_global.active }}
                <a href="{{ site.Params.custom.search_global.url }}">Recherche</a>
            {{ end }}

            <!-- Home CTA (current site or external) -->
            <a href="{{ $home_url }}">Accueil</a>
        </div>
    </div>
</header>
